<!DOCTYPE html>
<html>
  <%- include('includes/head', { title }) %>
  <body>
    <%- include('includes/header', { isLoggedIn, char, title: page.title }) %>
    <nav class="page">
      <li class="active">Read</li>
      <% if (isLoggedIn) { %>
      <li><a href="/<%= page.path %>/edit">Edit</a></li>
      <% } %>
      <li><a href="/<%= page.path %>/history">History</a></li>
    </nav>
    <main>
      <% if (page.file?.url && page.types.includes('Image file')) { %>
      <img src="<%= page.file.url %>" alt="<%= page.title %>" />
      <% } else if (page.file?.url && !page.types.includes('Image file')) { %>
      <a href="<%= page.file.url%>" class="download">
        <strong>Download file</strong>
        <small><%= page.file.mimetype %>; <%= page.file.size %></small>
      </a>
      <% } %>
      <%- markup %>
      <% if (locals.subcategories && subcategories.length > 0) { %>
      <section class="subcategories">
        <h2>Subcategories</h2>
        <ul class="category-listing">
          <% for (const subcat of subcategories) { %>
          <li><a href="/<%= subcat.path %>"><%= subcat.title %></a></li>
          <% } %>
        </ul>
      </section>
      <% } %>
      <% if (locals.pages && pages.length > 0) { %>
      <section class="category-pages">
        <h2>Pages in category &ldquo;<%= page.title %>&rdquo;</h2>
        <ul class="category-listing">
          <% for (const p of pages) { %>
          <li><a href="/<%= p.path %>"><%= p.title %></a></li>
          <% } %>
        </ul>
      </section>
      <% } %>
      <% if (locals.categories && categories.length > 0) { %>
      <ul class="categories">
        <% for (const category of categories) { %>
        <li>
          <a href="/<%= category.path %>"><%= category.title %></a>
        </li>
        <% } %>
      </ul>
      <% } %>
    </main>
    <%- include('includes/footer') %>
  </body>
</html>
